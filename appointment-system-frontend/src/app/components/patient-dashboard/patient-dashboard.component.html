<div class="container mt-4">
  <h1 class="mb-4 text-center section-title">Dostępne Wizyty</h1>

  <!-- Filtry -->
  <div class="card mb-4">
    <div class="card-header">Filtruj wizyty</div>
    <div class="card-body">
      <div class="form-row">
        <div class="form-group col-md-3">
          <label for="filterDate">Data</label>
          <input type="date" class="form-control" id="filterDate" [(ngModel)]="filterDate">
        </div>
        <div class="form-group col-md-3">
          <label for="filterSpecialization">Specjalizacja</label>
          <select class="form-control" id="filterSpecialization" [(ngModel)]="filterSpecialization">
            <option value="">Wszystkie</option>
            <option *ngFor="let spec of specializations" [value]="spec">{{ spec }}</option>
          </select>
        </div>
        <div class="form-group col-md-3">
          <label for="filterDoctor">Lekarz</label>
          <select class="form-control" id="filterDoctor" [(ngModel)]="filterDoctor">
            <option value="">Wszyscy</option>
            <option *ngFor="let doc of doctors" [value]="doc">{{ doc }}</option>
          </select>
        </div>
        <div class="form-group col-md-3 d-flex align-items-end">
          <button class="btn btn-outline-primary btn-block" (click)="applyFilters()">Filtruj</button>
        </div>
      </div>
    </div>
  </div>


  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <!-- Dostępne wizyty -->
  <table class="table table-striped table-bordered text-center">
    <thead>
    <tr>
      <th style="width: 5%;">ID</th>
      <th style="width: 20%;">Usługa</th>
      <th style="width: 25%;">Data i Godzina</th>
      <th style="width: 15%;">Cena</th>
      <th style="width: 20%;">Lekarz</th>
      <th style="width: 15%;">Akcja</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let appt of availableAppointments">
      <td>{{ appt.id }}</td>
      <td>{{ appt.service.name }}</td>
      <td>{{ appt.availableTime | date: 'yyyy-MM-dd HH:mm' }}</td>
      <td>{{ appt.price }} zł</td>
      <td>{{ appt.doctor.name }}</td>
      <td>
        <button class="btn btn-outline-success btn-sm" (click)="bookAppointment(appt.id)">
          Zarezerwuj
        </button>
      </td>
    </tr>
    </tbody>
  </table>

  <div *ngIf="availableAppointments.length === 0" class="text-center text-muted">
    Brak dostępnych wizyt.
  </div>

  <!-- Zarezerwowane wizyty -->
  <h1 class="mt-5 mb-3 text-center section-title">Zarezerwowane Wizyty</h1>
  <table class="table table-striped table-bordered text-center">
    <thead>
    <tr>
      <th style="width: 5%;">ID</th>
      <th style="width: 20%;">Usługa</th>
      <th style="width: 25%;">Data i Godzina</th>
      <th style="width: 15%;">Cena</th>
      <th style="width: 20%;">Lekarz</th>
      <th style="width: 15%;">Akcja</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let appt of reservedAppointments">
      <td>{{ appt.id }}</td>
      <td>{{ appt.service.name }}</td>
      <td>{{ appt.availableTime | date: 'yyyy-MM-dd HH:mm' }}</td>
      <td>{{ appt.price }} zł</td>
      <td>{{ appt.doctor.name }}</td>
      <td>
        <button
          *ngIf="appt.isBooked"
          class="btn btn-outline-danger btn-sm"
          (click)="cancelAppointment(appt.id)"
        >
          Usuń
        </button>
      </td>
    </tr>
    </tbody>
  </table>

  <div *ngIf="reservedAppointments.length === 0" class="text-center text-muted">
    Brak zarezerwowanych wizyt.
  </div>
</div>
